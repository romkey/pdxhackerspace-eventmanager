<%# SEO Meta Tags %>
<% page_title "Location" %>
<% page_description "Find us at #{@site_config&.address || @site_config&.organization_name || 'our hackerspace'}. Get directions and location information." %>
<% canonical_url location_info_url %>

<%# Breadcrumb JSON-LD %>
<% content_for :json_ld do %>
  <script type="application/ld+json"><%= breadcrumb_json_ld([
    { name: 'Home', url: root_url },
    { name: 'Location', url: location_info_url }
  ]) %></script>
<% end %>

<div class="row">
  <div class="col-lg-8 mx-auto">
    <h1><i class="bi bi-geo-alt-fill" aria-hidden="true"></i> Location</h1>

    <% if @site_config.location_info.present? || @site_config.address.present? %>
      <% if @site_config.location_info.present? %>
        <section class="card mb-4" aria-labelledby="about-location-heading">
          <div class="card-body">
            <h2 class="card-title h5" id="about-location-heading">About Our Location</h2>
            <%= simple_format(@site_config.location_info) %>
          </div>
        </section>
      <% end %>

      <% if @site_config.address.present? %>
        <section class="card mb-4" aria-labelledby="address-heading">
          <div class="card-body">
            <h2 class="card-title h5" id="address-heading">Address</h2>
            <address class="lead">
              <i class="bi bi-pin-map-fill" aria-hidden="true"></i> <%= @site_config.address %>
            </address>

            <div class="ratio ratio-16x9 mt-3">
              <iframe
                width="100%"
                height="450"
                style="border:0"
                loading="lazy"
                allowfullscreen
                referrerpolicy="no-referrer-when-downgrade"
                title="Map showing location of <%= @site_config&.organization_name || 'our hackerspace' %>"
                src="https://maps.google.com/maps?q=<%= ERB::Util.url_encode(@site_config.address) %>&t=&z=15&ie=UTF8&iwloc=&output=embed">
              </iframe>
            </div>
            <small class="text-muted d-block mt-2">
              <%= link_to "Open in Google Maps", "https://www.google.com/maps/search/?api=1&query=#{ERB::Util.url_encode(@site_config.address)}", target: "_blank", rel: "noopener noreferrer", class: "text-decoration-none", "aria-label": "Open address in Google Maps (opens in new tab)" %>
            </small>
          </div>
        </section>
      <% end %>
    <% else %>
      <div class="alert alert-info" role="status">
        <p class="mb-0">Location information has not been configured yet.</p>
        <% if user_signed_in? && current_user.admin? %>
          <hr>
          <%= link_to "Configure Location Info", edit_site_config_path, class: "alert-link" %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

